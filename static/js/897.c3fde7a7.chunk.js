"use strict";(self.webpackChunkhr_start_up_admin_panel=self.webpackChunkhr_start_up_admin_panel||[]).push([[897],{1897:function(n,e,i){i.r(e),i.d(e,{default:function(){return wn}});var t,r,s,a,d,o,l,u,c,f,p,x,h,g,v,Z,m,w,j,b,y,D,P,k,M=i(3433),N=i(1413),I=i(4165),S=i(5861),A=i(9439),C=i(2791),E=i(168),_=i(6444),O=i(2450),L=_.ZP.div(t||(t=(0,E.Z)(["\n  display: flex;\n  flex-direction: column;\n  grid-row-gap: 24px;\n  width: 100%;\n  height: 100%;\n  padding: 24px;\n"]))),G=_.ZP.div(r||(r=(0,E.Z)(["\n  display: flex;\n  width: 100%;\n  height: 100%;\n  overflow-x: auto;\n  border: 1px solid ",";\n  background: ",";\n  border-radius: 5px;\n"])),O.D.lightGray40,O.D.white),X=_.ZP.div(s||(s=(0,E.Z)(["\n  max-width: ",";\n  height: 100%;\n  overflow-y: auto;\n\n  &::-webkit-scrollbar {\n    width: 0;\n  }\n"])),(function(n){return n.hasActive?"400px":"100%"})),B=_.ZP.div(a||(a=(0,E.Z)(["\n  display: flex;\n  flex-direction: column;\n  max-width: ",";\n  width: 100%;\n  min-height: 100%;\n  height: fit-content;\n  border-right: ",";\n  background: ",";\n  overflow: hidden;\n"])),(function(n){return n.hasActive?"400px":"100%"}),(function(n){return n.hasActive?"1px solid ".concat(O.D.lightGray40):"none"}),O.D.white),z=_.ZP.div(d||(d=(0,E.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n"]))),J=(_.ZP.div(o||(o=(0,E.Z)(["\n  --min-width: 231px;\n  grid-gap: 16px;\n  display: grid;\n  grid-template-columns: 231px 231px 231px 340px;\n  width: 100%;\n  padding: 16px;\n  background: ",";\n  box-shadow: 0 7px 15px rgba(0,0,0,.05);\n  border-radius: 10px;\n"])),O.D.white),i(9353)),q=i(9514),Q=i(4346),F=i(6200),H=_.ZP.div(l||(l=(0,E.Z)(["\n  display: flex;\n  align-items: center;\n  width: 100%;\n  gap: 12px;\n  cursor: pointer;\n  transition: background-color .3s;\n  padding: 10px;\n  overflow: hidden;\n  \n  &:hover {\n    background-color: ",";\n  }\n"])),O.D.blue20),K=_.ZP.div(u||(u=(0,E.Z)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 5px;\n  width: 100%;\n"]))),R=_.ZP.div(c||(c=(0,E.Z)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  overflow: hidden;\n  gap: 5px;\n"]))),T=(0,_.ZP)(J.g2)(f||(f=(0,E.Z)(["\n  \n"]))),U=_.ZP.div(p||(p=(0,E.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  min-width: 20px;\n  height: 20px;\n  min-height: 20px;\n  background-color: ",";\n  color: ",";\n  border-radius: 10px;\n"])),O.D.blue60,O.D.white),V=(0,_.ZP)(J.g2)(x||(x=(0,E.Z)(["\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"]))),W=_.ZP.div(h||(h=(0,E.Z)(["\n  color: ",";\n"])),O.D.gray90),Y=i(595),$=i(184),nn=function(n){var e=n.dialog,i=n.onClick;return(0,$.jsxs)(H,{onClick:i,children:[(0,$.jsx)(J.qE,{userId:e.user.id,firstName:e.user.firstName,lastName:e.user.lastName,src:e.user.avatar,size:J.DZ.XXXL}),(0,$.jsxs)(R,{children:[(0,$.jsxs)(K,{children:[(0,$.jsxs)(V,{tooltip:!0,children:[e.user.lastName," ",e.user.firstName," (",e.user.email,")"]}),(0,$.jsx)(W,{children:(0,Y.B)(e.lastMessage.updatedAt)})]}),(0,$.jsxs)(K,{children:[(0,$.jsx)(T,{children:e.lastMessage.text}),Boolean(e.unreadableMessages)&&(0,$.jsx)(U,{children:e.unreadableMessages})]})]})]})},en=i(7512),tn=i(3131),rn=_.ZP.div(g||(g=(0,E.Z)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n"]))),sn=_.ZP.div(v||(v=(0,E.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  gap: 10px;\n  width: 100%;\n  height: fit-content;\n  min-height: 100%;\n  padding: 10px;\n"]))),an=_.ZP.div(Z||(Z=(0,E.Z)(["\n  width: 100%;\n  height: 100%;\n  overflow-y: auto;\n  \n  &::-webkit-scrollbar {\n    width: 0;\n  }\n"]))),dn=_.ZP.div(m||(m=(0,E.Z)(["\n  display: flex;\n  gap: 10px;\n  align-items: center;\n  padding: 10px;\n  border-top: 1px solid ",";\n"])),O.D.lightGray40),on=(0,_.ZP)(tn.I)(w||(w=(0,E.Z)(["\n  cursor: pointer;\n  color: ",";\n  transition: color .3s;\n  \n  &:hover {\n    color: ",";\n  }\n"])),O.D.gray60,O.D.blue60),ln=_.ZP.div(j||(j=(0,E.Z)(["\n  font-weight: 500;\n"]))),un=_.ZP.div(b||(b=(0,E.Z)(["\n  display: flex;\n  gap: 10px;\n  align-items: center;\n  padding: 10px;\n  border-bottom: 1px solid ",";\n  box-shadow: 0 7px 15px rgba(0,0,0,.05);\n"])),O.D.lightGray40),cn=_.ZP.div(y||(y=(0,E.Z)(["\n  display: flex;\n  width: 100%;\n  justify-content: ",";\n"])),(function(n){return n.isOwn?"flex-end":"flex-start"})),fn=_.ZP.div(D||(D=(0,E.Z)(["\n  display: flex;\n  align-items: flex-end;\n  gap: 10px;\n  width: fit-content;\n  height: fit-content;\n  padding: 8px 8px 4px 8px;\n  border-radius: 5px;\n  background-color: ",";\n"])),(function(n){return n.isOwn?O.D.blue30:O.D.lightGray30})),pn=_.ZP.div(P||(P=(0,E.Z)(["\n  padding-bottom: 5px;\n"]))),xn=_.ZP.div(k||(k=(0,E.Z)(["\n  color: ","\n"])),O.D.gray90),hn=i(3494),gn=function(n){var e=n.message,i=(0,hn.aC)().user,t=(0,C.useMemo)((function(){return e.user.id===(null===i||void 0===i?void 0:i.id)}),[e,i]);return(0,$.jsx)(cn,{isOwn:t,children:(0,$.jsxs)(fn,{isOwn:t,children:[(0,$.jsx)(pn,{children:e.text}),(0,$.jsx)(xn,{children:(0,Y.B)(e.updatedAt)})]})})},vn=i(3442),Zn=i(1219),mn=function(n){var e=n.dialogId,i=n.user,t=n.onBack,r=(0,C.useState)(!0),s=(0,A.Z)(r,2),a=s[0],d=s[1],o=(0,C.useState)([]),l=(0,A.Z)(o,2),u=l[0],c=l[1],f=(0,C.useState)(""),p=(0,A.Z)(f,2),x=p[0],h=p[1],g=function(){var n=(0,S.Z)((0,I.Z)().mark((function n(){var i;return(0,I.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,d(!0),n.next=4,Q.m.fetchDialogInfo(e);case 4:i=n.sent,c(i.data.messages),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),(0,q._N)(n.t0);case 11:return n.prev=11,d(!1),n.finish(11);case 14:case"end":return n.stop()}}),n,null,[[0,8,11,14]])})));return function(){return n.apply(this,arguments)}}();(0,C.useEffect)((function(){var n=vn.v.addListenerOfMessage((function(n){var i=JSON.parse(n);i.event===Zn.u.MESSAGE&&i.dialogId===e&&c((function(n){return[].concat((0,M.Z)(n),[i])}))}));return function(){vn.v.removeListenerOfMessage(n)}}),[]),(0,C.useEffect)((function(){g()}),[e]);var v=(0,C.useMemo)((function(){return a?(0,$.jsx)(J.QP,{}):u.length?u.map((function(n){return(0,$.jsx)(gn,{message:n},n.id)})):"\u041d\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439"}),[u,a]);return(0,$.jsxs)(rn,{children:[(0,$.jsxs)(un,{children:[t&&(0,$.jsx)(J.zx,{onClick:t,children:(0,$.jsx)(tn.I,{type:"arrow-left"})}),(0,$.jsx)(J.qE,{userId:i.id,firstName:i.firstName,size:J.DZ.XXXL,lastName:i.lastName,src:i.avatar}),(0,$.jsxs)(ln,{children:[i.lastName," ",i.firstName," (",i.email,")"]})]}),(0,$.jsx)(an,{children:(0,$.jsx)(sn,{children:v})}),(0,$.jsxs)(dn,{children:[(0,$.jsx)(J.gx,{value:x,onChange:function(n){return h(n.target.value)},placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"}),(0,$.jsx)(on,{type:"send",onClick:function(){vn.v.sendMessage({dialogId:e,text:x}),h("")},size:tn.J.XL})]})]})},wn=function(){var n=(0,hn.aC)().user,e=(0,en._)(),i=e.newDialog,t=e.clearNewDialog,r=e.activeDialog,s=e.setActiveDialog,a=(0,C.useState)([]),d=(0,A.Z)(a,2),o=d[0],l=d[1],u=(0,C.useState)(!0),c=(0,A.Z)(u,2),f=c[0],p=c[1],x=(0,C.useState)(""),h=(0,A.Z)(x,2),g=h[0],v=h[1],Z=(0,F.Nr)(g,400),m=(0,F.Lm)();(0,C.useEffect)((function(){if(i){var e=i.users.find((function(e){return e.id!==(null===n||void 0===n?void 0:n.id)}));e&&s({id:i.id,user:e}),t()}}),[i]);var w=function(){var n=(0,S.Z)((0,I.Z)().mark((function n(){var e;return(0,I.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,p(!0),n.next=4,Q.m.fetchDialogs();case 4:e=n.sent,l(e.data),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),(0,q._N)(n.t0);case 11:return n.prev=11,p(!1),n.finish(11);case 14:case"end":return n.stop()}}),n,null,[[0,8,11,14]])})));return function(){return n.apply(this,arguments)}}();(0,C.useEffect)((function(){w()}),[Z]);var j=function(){s(void 0),w()},b=(0,C.useMemo)((function(){return m>1010}),[m]),y=function(n){s(n),l((function(e){return e.map((function(e){return e.id===n.id&&(e.unreadableMessages=0),(0,N.Z)({},e)}))}))};(0,C.useEffect)((function(){var e=vn.v.addListenerOfMessage((function(e){var i=JSON.parse(e);i.event===Zn.u.MESSAGE&&(i.user.id===(null===n||void 0===n?void 0:n.id)||o.find((function(n){return n.id===i.dialogId}))?l((function(e){return e.map((function(e){return e.id===i.dialogId&&(null===n||void 0===n?void 0:n.id)!==i.user.id&&(e.unreadableMessages+=1,e.lastMessage=i),e.id===i.dialogId&&(null===n||void 0===n?void 0:n.id)===i.user.id&&(e.lastMessage=(0,N.Z)((0,N.Z)({},i),{},{read:!0})),(0,N.Z)({},e)})).sort((function(n,e){return Date.parse(e.lastMessage.updatedAt)-Date.parse(n.lastMessage.updatedAt)}))})):l((function(n){return[{id:i.dialogId,user:i.user,unreadableMessages:1,lastMessage:i}].concat((0,M.Z)(n))})))}));return function(){vn.v.removeListenerOfMessage(e)}}),[]);var D=(0,C.useMemo)((function(){return f?(0,$.jsx)(J.QP,{}):o.length?r?(0,$.jsxs)(G,{children:[b&&(0,$.jsx)(X,{hasActive:!0,children:(0,$.jsx)(B,{hasActive:!0,children:o.map((function(n){return(0,$.jsx)(nn,{dialog:n,onClick:function(){return y(n)}},n.id)}))})}),(0,$.jsx)(mn,{dialogId:r.id,user:r.user,onBack:b?void 0:j})]}):(0,$.jsx)(G,{children:(0,$.jsx)(B,{children:o.map((function(n){return(0,$.jsx)(nn,{dialog:n,onClick:function(){return y(n)}},n.id)}))})}):(0,$.jsx)(z,{children:"\u0414\u0438\u0430\u043b\u043e\u0433\u043e\u0432 \u043d\u0435\u0442"})}),[o,f,r,b]);return(0,$.jsxs)(L,{children:[(0,$.jsx)(J.mr,{title:"\u0414\u0438\u0430\u043b\u043e\u0433\u0438",search:g,onChangeSearch:function(n){v(n.target.value)}}),D]})}}}]);
//# sourceMappingURL=897.c3fde7a7.chunk.js.map