"use strict";(self.webpackChunkhr_start_up_admin_panel=self.webpackChunkhr_start_up_admin_panel||[]).push([[897],{5457:function(n,e,i){i.d(e,{V:function(){return C},w:function(){return P}});var t,r,o,s,a,l,d,c,u=i(1413),h=(i(2791),i(3131)),p=i(6031),f=i(168),x=i(6444),g=i(2450),v=x.ZP.div(t||(t=(0,f.Z)(["\n  display: flex;\n  justify-content: space-evenly;\n  gap: 16px;\n"]))),Z=(0,x.ZP)(p.zx)(r||(r=(0,f.Z)(["\n  width: 50%;\n"]))),m=x.ZP.div(o||(o=(0,f.Z)(["\n  padding: 56px 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16px;\n"]))),w=x.ZP.div(s||(s=(0,f.Z)(["\n  width: 56px;\n  height: 56px;\n  padding: 16px;\n  border-radius: 50%;\n  &.answer {\n    color: ",";\n    background-color: ",";\n  }\n  &.notification {\n    color: ",";\n    background-color: ",";\n  }\n  &.warning {\n    color: ",";\n    background-color: ",";\n  }\n  &.info {\n    color: ",";\n    background-color: ",";\n  }\n"])),g.D.yellow70,g.D.yellow30,g.D.green70,g.D.green30,g.D.red70,g.D.red30,g.D.blue70,g.D.blue30),j=x.ZP.div(a||(a=(0,f.Z)(["\n  text-align: center;\n  width: 100%;\n"]))),b=x.ZP.div(l||(l=(0,f.Z)(["\n  width: 600px;\n  position: relative;\n"]))),y=x.ZP.div(d||(d=(0,f.Z)(["\n  position: absolute;\n  z-index: 1;\n  top: 0;\n  right: 0;\n  cursor: pointer;\n  color: ",";\n  transition: color 0.2s;\n\n  &:hover {\n    color: ",";\n  }\n"])),g.D.gray60,g.D.darkGray150),D=x.ZP.div(c||(c=(0,f.Z)(["\n  font-weight: 600;\n  font-size: 24px;\n  line-height: 32px;\n  letter-spacing: -0.019em;\n"]))),k=i(184),P=function(n){return n.ANSWER="answer",n.NOTIFICATION="notification",n.WARNING="warning",n.INFO="info",n}({}),N={answer:"circle-warning",notification:"circle-information",warning:"warning",info:"circle-information"},C=function(n){var e=n.loading,i=n.className,t=n.title,r=n.type,o=n.closeHandler,s=n.onConfirm,a=n.onOk,l=n.actions,d=n.children;return(0,k.jsx)(p.u_,{open:!0,closeOnDocumentClick:!1,onClose:o,children:(0,k.jsxs)(b,{className:i,children:[(0,k.jsx)(y,{onClick:o,children:(0,k.jsx)(h.I,{type:"close"})}),(0,k.jsxs)(m,{children:[r&&(0,k.jsx)(w,{className:r,children:(0,k.jsx)(h.I,{type:N[r]})}),t&&(0,k.jsx)(D,{children:t}),(0,k.jsx)(j,{children:d})]}),(0,k.jsx)(v,{children:s?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Z,(0,u.Z)((0,u.Z)({},null===l||void 0===l?void 0:l.submit),{},{variant:r===P.WARNING?p.Wu.DANGER:p.Wu.FILLED,onClick:s,isLoading:e,disabled:e})),(0,k.jsx)(Z,(0,u.Z)((0,u.Z)({},null===l||void 0===l?void 0:l.cancel),{},{id:"ConfirmDialogCancel",variant:p.Wu.OUTLINE,onClick:o,disabled:e}))]}):(0,k.jsx)(Z,(0,u.Z)({onClick:a,isLoading:e},null===l||void 0===l?void 0:l.ok))})]})})}},1897:function(n,e,i){i.r(e),i.d(e,{default:function(){return En}});var t,r,o,s,a,l,d,c,u,h,p,f,x,g,v,Z,m,w,j,b,y,D,k,P,N,C,I,E=i(3433),M=i(1413),S=i(4165),A=i(5861),G=i(9439),O=i(2791),L=i(168),_=i(6444),T=i(2450),H=_.ZP.div(t||(t=(0,L.Z)(["\n  display: flex;\n  flex-direction: column;\n  grid-row-gap: 24px;\n  width: 100%;\n  height: 100%;\n  padding: 24px;\n"]))),W=_.ZP.div(r||(r=(0,L.Z)(["\n  display: flex;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  border: 1px solid ",";\n  background: ",";\n  border-radius: 5px;\n"])),T.D.lightGray40,T.D.white),z=_.ZP.div(o||(o=(0,L.Z)(["\n  max-width: ",";\n  height: 100%;\n  width: 100%;\n  overflow-y: auto;\n\n  &::-webkit-scrollbar {\n    width: 0;\n  }\n"])),(function(n){return n.hasActive?"400px":"100%"})),R=_.ZP.div(s||(s=(0,L.Z)(["\n  display: flex;\n  flex-direction: column;\n  max-width: ",";\n  width: 100%;\n  min-height: 100%;\n  height: fit-content;\n  border-right: ",";\n  background: ",";\n  overflow: hidden;\n"])),(function(n){return n.hasActive?"400px":"100%"}),(function(n){return n.hasActive?"1px solid ".concat(T.D.lightGray40):"none"}),T.D.white),X=_.ZP.div(a||(a=(0,L.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n"]))),B=i(6031),F=i(9514),J=i(4346),V=i(4469),q=_.ZP.div(l||(l=(0,L.Z)(["\n  display: flex;\n  align-items: center;\n  width: 100%;\n  gap: 12px;\n  cursor: pointer;\n  height: fit-content;\n  transition: background-color .3s;\n  padding: 10px;\n  overflow: hidden;\n  \n  &:hover {\n    background-color: ",";\n  }\n"])),T.D.blue20),Q=_.ZP.div(d||(d=(0,L.Z)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 5px;\n  width: 100%;\n"]))),U=_.ZP.div(c||(c=(0,L.Z)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  overflow: hidden;\n  gap: 5px;\n"]))),K=(0,_.ZP)(B.g2)(u||(u=(0,L.Z)(["\n  white-space: nowrap;\n  color: ",";\n  min-width: 0;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"])),T.D.gray90),Y=_.ZP.div(h||(h=(0,L.Z)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  min-width: 20px;\n  height: 20px;\n  min-height: 20px;\n  background-color: ",";\n  color: ",";\n  border-radius: 10px;\n"])),T.D.blue60,T.D.white),$=(0,_.ZP)(B.g2)(p||(p=(0,L.Z)(["\n  font-weight: 500;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"]))),nn=_.ZP.div(f||(f=(0,L.Z)(["\n  color: ",";\n  white-space: nowrap;\n"])),T.D.gray90),en=i(595),tn=i(184),rn=function(n){var e=n.dialog,i=n.onClick;return(0,tn.jsxs)(q,{onClick:i,children:[(0,tn.jsx)(B.qE,{userId:e.user.id,firstName:e.user.firstName,lastName:e.user.lastName,src:e.user.avatar,size:B.DZ.XXXL}),(0,tn.jsxs)(U,{children:[(0,tn.jsxs)(Q,{children:[(0,tn.jsxs)($,{tooltip:!0,children:[e.user.lastName," ",e.user.firstName," (",e.user.email,")"]}),(0,tn.jsx)(nn,{children:(0,en.B)(e.lastMessage.updatedAt)})]}),(0,tn.jsxs)(Q,{children:[(0,tn.jsx)(K,{children:e.lastMessage.text}),Boolean(e.unreadableMessages)&&(0,tn.jsx)(Y,{children:e.unreadableMessages})]})]})]})},on=i(7512),sn=i(3131),an=_.ZP.div(x||(x=(0,L.Z)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n"]))),ln=_.ZP.div(g||(g=(0,L.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  gap: 10px;\n  width: 100%;\n  height: fit-content;\n  min-height: 100%;\n  padding: 10px;\n"]))),dn=_.ZP.div(v||(v=(0,L.Z)(["\n  position: absolute;\n  cursor: pointer;\n  bottom: 20px;\n  left: calc(50% - 69px);\n  display: flex;\n  padding: 4px 8px;\n  border-radius: 5px;\n  color: ",";\n  background-color: ",";\n  \n  &:hover {\n    background-color: ",";\n  }\n\n  &:active,\n  &.active {\n    background-color: ",";\n  }\n"])),T.D.lightGray10,T.D.blue60,T.D.blue70,T.D.blue80),cn=_.ZP.div(Z||(Z=(0,L.Z)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n"]))),un=_.ZP.div(m||(m=(0,L.Z)(["\n  width: 100%;\n  height: 100%;\n  overflow-y: auto;\n  position: relative;\n\n  &::-webkit-scrollbar {\n    width: 0;\n  }\n"]))),hn=_.ZP.form(w||(w=(0,L.Z)(["\n  display: flex;\n  gap: 10px;\n  align-items: center;\n  padding: 10px;\n  border-top: 1px solid ",";\n"])),T.D.lightGray40),pn=_.ZP.button(j||(j=(0,L.Z)(["\n  background: transparent;\n"]))),fn=(0,_.ZP)(sn.I)(b||(b=(0,L.Z)(["\n  cursor: pointer;\n  color: ",";\n  transition: color .3s;\n  \n  &:hover {\n    color: ",";\n  }\n"])),T.D.gray60,T.D.blue60),xn=_.ZP.div(y||(y=(0,L.Z)(["\n  font-weight: 500;\n"]))),gn=_.ZP.div(D||(D=(0,L.Z)(["\n  display: flex;\n  gap: 10px;\n  align-items: center;\n  padding: 10px;\n  border-bottom: 1px solid ",";\n  box-shadow: 0 7px 15px rgba(0,0,0,.05);\n"])),T.D.lightGray40),vn=i(4075),Zn=_.ZP.div(k||(k=(0,L.Z)(["\n  display: flex;\n  position: relative;\n  width: 100%;\n  justify-content: ",";\n"])),(function(n){return n.isOwn?"flex-end":"flex-start"})),mn=_.ZP.div(P||(P=(0,L.Z)(["\n  display: flex;\n  align-items: flex-end;\n  position: relative;\n  gap: 10px;\n  width: fit-content;\n  height: fit-content;\n  padding: 8px 8px 4px 8px;\n  max-width: calc(50% - 10px);\n  border-radius: 5px;\n  background-color: ",";\n"])),(function(n){return n.isOwn?T.D.blue30:T.D.lightGray30})),wn=(0,_.ZP)(vn.L)(N||(N=(0,L.Z)(["\n  width: 200px;\n  top: -43px !important;\n  left: -150px;\n  \n  & > div {\n    background: ",";\n  }\n"])),T.D.blue20),jn=_.ZP.div(C||(C=(0,L.Z)(["\n  padding-bottom: 5px;\n"]))),bn=_.ZP.div(I||(I=(0,L.Z)(["\n  color: ","\n"])),T.D.gray90),yn=i(3494),Dn=i(5457),kn=i(9847),Pn=function(n){var e=n.message,i=(0,yn.aC)().user,t=(0,O.useRef)(null),r=(0,V.te)(),o=(0,V.te)(),s=(0,O.useMemo)((function(){return e.user.id===(null===i||void 0===i?void 0:i.id)}),[e,i]);return(0,tn.jsxs)(Zn,{isOwn:s,children:[(0,tn.jsxs)(mn,{ref:t,isOwn:s,onContextMenu:function(n){n.preventDefault(),s&&o.open()},children:[(0,tn.jsx)(jn,{children:e.text}),(0,tn.jsx)(bn,{children:(0,en.B)(e.updatedAt)}),o.isOpen&&(0,tn.jsx)(wn,{selectionContainer:t.current,onClose:o.close,children:(0,tn.jsx)(B.zx,{variant:B.Wu.DANGER,text:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",fullWidth:!0,onClick:r.open})})]}),r.isOpen&&(0,tn.jsx)(Dn.V,{type:Dn.w.WARNING,closeHandler:r.close,onConfirm:function(){kn.v.deleteMessage({messageId:e.id}),r.close()},actions:{cancel:{text:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c",onClick:r.close},submit:{text:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}},children:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435?"})]})},Nn=i(1219),Cn=i(5705),In=function(n){var e=n.dialogId,i=n.user,t=n.onBack,r=(0,yn.aC)().user,o=(0,O.useState)(!0),s=(0,G.Z)(o,2),a=s[0],l=s[1],d=(0,O.useState)([]),c=(0,G.Z)(d,2),u=c[0],h=c[1],p=(0,O.useRef)(null),f=(0,O.useState)(!1),x=(0,G.Z)(f,2),g=x[0],v=x[1],Z=(0,Cn.TA)({initialValues:{message:""},onSubmit:function(n){m(n.message)}}),m=function(n){kn.v.sendMessage({dialogId:e,text:n}),Z.resetForm()},w=function(){var n=(0,A.Z)((0,S.Z)().mark((function n(){var i;return(0,S.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,l(!0),n.next=4,J.m.fetchDialogInfo(e);case 4:i=n.sent,h(i.data.messages),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),(0,F._N)(n.t0);case 11:return n.prev=11,l(!1),n.finish(11);case 14:case"end":return n.stop()}}),n,null,[[0,8,11,14]])})));return function(){return n.apply(this,arguments)}}();(0,V.ie)((function(n){var i,t,o,s=JSON.parse(n);s.event===Nn.u.MESSAGE&&s.dialogId===e&&(h((function(n){return[].concat((0,E.Z)(n),[s])})),s.user.id!==(null===r||void 0===r?void 0:r.id)&&(kn.v.readMessage({messageId:s.id}),p.current&&(null===(i=p.current)||void 0===i?void 0:i.scrollHeight)-(null===(t=p.current)||void 0===t?void 0:t.clientHeight)-(null===(o=p.current)||void 0===o?void 0:o.scrollTop)>=50&&v(!0)));if(s.event===Nn.u.DELETE_MESSAGE){var a=JSON.parse(n);a.dialogId===e&&h((function(n){return n.filter((function(n){return n.id!==a.messageId}))}))}}),[e,r]);var j=function(){var n,e;null===(n=p.current)||void 0===n||n.scrollTo(0,null===(e=p.current)||void 0===e?void 0:e.scrollHeight)};(0,O.useLayoutEffect)((function(){if(p.current){var n,e,i,t=u[u.length-1],o=(null===(n=p.current)||void 0===n?void 0:n.scrollHeight)-(null===(e=p.current)||void 0===e?void 0:e.clientHeight)-(null===(i=p.current)||void 0===i?void 0:i.scrollTop);(t&&t.user.id===(null===r||void 0===r?void 0:r.id)||o<50)&&j()}}),[u]),(0,O.useLayoutEffect)((function(){a||j()}),[a]),(0,O.useEffect)((function(){w()}),[e]);var b=(0,O.useMemo)((function(){return a?(0,tn.jsx)(B.QP,{}):u.length?u.map((function(n){return(0,tn.jsx)(Pn,{message:n},n.id)})):"\u041d\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439"}),[u,a]);return(0,tn.jsxs)(an,{children:[(0,tn.jsxs)(gn,{children:[t&&(0,tn.jsx)(B.zx,{onClick:t,children:(0,tn.jsx)(sn.I,{type:"arrow-left"})}),(0,tn.jsx)(B.qE,{userId:i.id,firstName:i.firstName,size:B.DZ.XXXL,lastName:i.lastName,src:i.avatar}),(0,tn.jsxs)(xn,{children:[i.lastName," ",i.firstName," (",i.email,")"]})]}),(0,tn.jsxs)(cn,{children:[(0,tn.jsx)(un,{ref:p,onScroll:function(){var n,e,i;p.current&&((null===(n=p.current)||void 0===n?void 0:n.scrollHeight)-(null===(e=p.current)||void 0===e?void 0:e.clientHeight)-(null===(i=p.current)||void 0===i?void 0:i.scrollTop)<25&&v(!1))},children:(0,tn.jsx)(ln,{children:b})}),g&&(0,tn.jsx)(dn,{onClick:j,children:"\u041d\u043e\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"})]}),(0,tn.jsxs)(hn,{onSubmit:Z.handleSubmit,children:[(0,tn.jsx)(B.gx,{name:"message",value:Z.values.message,onChange:Z.handleChange,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",onEnter:function(){return m(Z.values.message)}}),(0,tn.jsx)(pn,{children:(0,tn.jsx)(fn,{type:"send",size:sn.J.XL})})]})]})},En=function(){var n=(0,yn.aC)().user,e=(0,on._)(),i=e.newDialog,t=e.clearNewDialog,r=e.activeDialog,o=e.setActiveDialog,s=(0,O.useState)([]),a=(0,G.Z)(s,2),l=a[0],d=a[1],c=(0,O.useState)(!0),u=(0,G.Z)(c,2),h=u[0],p=u[1],f=(0,O.useState)(""),x=(0,G.Z)(f,2),g=x[0],v=x[1],Z=(0,V.Nr)(g,400),m=(0,V.Lm)();(0,O.useEffect)((function(){if(i){var e=i.users.find((function(e){return e.id!==(null===n||void 0===n?void 0:n.id)}));e&&o({id:i.id,user:e}),t()}}),[i]);var w=function(){var n=(0,A.Z)((0,S.Z)().mark((function n(){var e;return(0,S.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,p(!0),n.next=4,J.m.fetchDialogs();case 4:e=n.sent,d(e.data),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),(0,F._N)(n.t0);case 11:return n.prev=11,p(!1),n.finish(11);case 14:case"end":return n.stop()}}),n,null,[[0,8,11,14]])})));return function(){return n.apply(this,arguments)}}();(0,O.useEffect)((function(){w()}),[Z]);var j=function(){o(void 0),w()},b=(0,O.useMemo)((function(){return m>1010}),[m]),y=function(n){o(n),d((function(e){return e.map((function(e){return e.id===n.id&&(e.unreadableMessages=0),(0,M.Z)({},e)}))}))};(0,V.ie)((function(e){var i=JSON.parse(e);if(i.event===Nn.u.MESSAGE&&(l.find((function(n){return n.id===i.dialogId}))?d((function(e){return e.map((function(e){return e.id===i.dialogId&&(null===n||void 0===n?void 0:n.id)!==i.user.id&&((null===r||void 0===r?void 0:r.id)!==i.dialogId&&(e.unreadableMessages+=1),e.lastMessage=i),e.id===i.dialogId&&(null===n||void 0===n?void 0:n.id)===i.user.id&&(e.lastMessage=(0,M.Z)((0,M.Z)({},i),{},{read:!0})),(0,M.Z)({},e)})).sort((function(n,e){return Date.parse(e.lastMessage.updatedAt)-Date.parse(n.lastMessage.updatedAt)}))})):d((function(n){return[{id:i.dialogId,user:i.user,unreadableMessages:1,lastMessage:i}].concat((0,E.Z)(n))}))),i.event===Nn.u.DELETE_MESSAGE){var t=JSON.parse(e);d((function(n){return n.map((function(n){return n.id===t.dialogId?(0,M.Z)((0,M.Z)({},n),{},{lastMessage:t.lastMessage}):n}))}))}}),[l,n]);var D=(0,O.useMemo)((function(){return h?(0,tn.jsx)(B.QP,{}):l.length?r?(0,tn.jsxs)(W,{children:[b&&(0,tn.jsx)(z,{hasActive:!0,children:(0,tn.jsx)(R,{hasActive:!0,children:l.map((function(n){return(0,tn.jsx)(rn,{dialog:n,onClick:function(){return y(n)}},n.id)}))})}),(0,tn.jsx)(In,{dialogId:r.id,user:r.user,onBack:b?void 0:j})]}):(0,tn.jsx)(W,{children:(0,tn.jsx)(z,{children:(0,tn.jsx)(R,{children:l.map((function(n){return(0,tn.jsx)(rn,{dialog:n,onClick:function(){return y(n)}},n.id)}))})})}):(0,tn.jsx)(X,{children:"\u0414\u0438\u0430\u043b\u043e\u0433\u043e\u0432 \u043d\u0435\u0442"})}),[l,h,r,b]);return(0,tn.jsxs)(H,{children:[(0,tn.jsx)(B.mr,{title:"\u0414\u0438\u0430\u043b\u043e\u0433\u0438",search:g,onChangeSearch:function(n){v(n.target.value)}}),D]})}}}]);
//# sourceMappingURL=897.2c9e18b5.chunk.js.map